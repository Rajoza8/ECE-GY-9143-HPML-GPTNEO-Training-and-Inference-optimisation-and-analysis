deepspeed --include localhost:0,1 --master_port 29500 pretrain_gpt.py --tensor-model-parallel-size 2 --pipeline-model-parallel-size 1 --num-layers 32 --hidden-size 2560 --num-attention-heads 32 --seq-length 2048 --loss-scale 12 --max-position-embeddings 2048 --micro-batch-size 8 --global-batch-size 16 --train-iters 1000 --lr 6.0e-5 --min-lr 6.0e-6 --lr-decay-style cosine --log-interval 1 --eval-iters 40 --eval-interval 1000 --data-path /home/mm12318/HPML/Proj/output_data_text_document --vocab-file /home/mm12318/HPML/Proj/Megatron-DeepSpeed/vocab.json --merge-file /home/mm12318/HPML/Proj/Megatron-DeepSpeed/merges.txt --save-interval 1000 --split 98,2,0 --clip-grad 1.0 --weight-decay 0.1 --adam-beta1 0.9 --adam-beta2 0.95 --init-method-std 0.006 --fp16 --checkpoint-activations --tensorboard-dir ds_z3_nl32_hs2560_gb16_mb8 --deepspeed-activation-checkpointing --zero-stage=3 --deepspeed_config=ds_config.json --no-pipeline-parallel --deepspeed eyJ0cmFpbl9iYXRjaF9zaXplIjogImF1dG8iLCAidHJhaW5fbWljcm9fYmF0Y2hfc2l6ZV9wZXJfZ3B1IjogMSwgInN0ZXBzX3Blcl9wcmludCI6IDEwMCwgInplcm9fb3B0aW1pemF0aW9uIjogeyJzdGFnZSI6IDN9LCAiZnAxNiI6IHsiZW5hYmxlZCI6IHRydWUsICJpbml0aWFsX3NjYWxlX3Bvd2VyIjogMTJ9LCAiYXV0b3R1bmluZyI6IHsiZW5hYmxlZCI6IHRydWUsICJtb2RlbF9pbmZvX3BhdGgiOiAiYXV0b3R1bmluZ19yZXN1bHRzL3Byb2ZpbGVfbW9kZWxfaW5mby9tb2RlbF9pbmZvLmpzb24iLCAibW9kZWxfaW5mbyI6IHsicHJvZmlsZSI6IHRydWV9LCAibWV0cmljX3BhdGgiOiAiYXV0b3R1bmluZ19yZXN1bHRzL3Byb2ZpbGVfbW9kZWxfaW5mby9tZXRyaWNzLmpzb24ifSwgIndhbGxfY2xvY2tfYnJlYWtkb3duIjogdHJ1ZSwgInF1YW50aXplX3RyYWluaW5nIjogeyJlbmFibGVkIjogdHJ1ZSwgInF1YW50aXplX3ZlcmJvc2UiOiB0cnVlLCAicXVhbnRpemVyX2tlcm5lbCI6IHRydWUsICJxdWFudGl6ZS1hbGdvIjogeyJxX3R5cGUiOiAic3ltbWV0cmljIn0sICJxdWFudGl6ZV9iaXRzIjogeyJzdGFydF9iaXRzIjogMTYsICJ0YXJnZXRfYml0cyI6IDh9LCAicXVhbnRpemVfc2NoZWR1bGUiOiB7InF1YW50aXplX3BlcmlvZCI6IDQwMCwgInNjaGVkdWxlX29mZnNldCI6IDB9LCAicXVhbnRpemVfZ3JvdXBzIjogOH0sICJtZW1vcnlfYnJlYWtfZG93biI6IGZhbHNlfQ== --exit-interval 5000 --per_device_train_batch_size 1
